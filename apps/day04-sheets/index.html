<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>MiniSheet</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    :root { --bg: #0f1720; --panel:#0b1115; --muted:#97a0a6; --accent:#ffcc00; --cell-bg:#0f1416; }
    html.light { --bg: #f7f7f8; --panel:#ffffff; --muted:#6b7280; --cell-bg:#fff; }
    body { background: linear-gradient(180deg,#0b0f12, #111418); color:#e6eef2; font-family: Inter, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial; min-height:100vh; }
    .panel { background: linear-gradient(180deg, rgba(255,255,255,0.02), rgba(0,0,0,0.02)); border-radius:10px; padding:10px; border:1px solid rgba(255,255,255,0.03); }
    .smallmuted { color:var(--muted); font-size:0.9rem; background:transparent; border:0; cursor:pointer; }
    .sheet-header { background: linear-gradient(180deg, rgba(255,255,255,0.02), rgba(0,0,0,0.02)); color: #dbe6ea; padding:8px 10px; border-bottom:1px solid rgba(255,255,255,0.03); text-align:center; font-size:13px; font-weight:500; }
    .row-header { background:transparent; color:#b8c6cc; width:44px; text-align:center; border-right:1px solid rgba(255,255,255,0.02); padding:8px 6px; font-size:13px; font-weight:500; }
    table { width:100%; border-collapse:collapse; table-layout:fixed; }
    th, td { border-bottom:1px solid rgba(255,255,255,0.02); border-right:1px solid rgba(255,255,255,0.01); }
    td { background: transparent; min-width:60px; overflow:hidden; }
    .cell { width:100%; height:100%; box-sizing:border-box; }
    .col-resizer { width:10px; height:100%; cursor:col-resize; display:inline-block; }
    .row-handle { position:relative; }
    /* selection visuals */
    .cell.selected { background-color: rgba(79,140,255,0.06) !important; outline: 2px solid rgba(79,140,255,0.12) !important; }
    /* adjust grid viewport */
    #gridViewport { overflow:auto; height: calc(100vh - 140px); }
    /* toolbar button */
    .toolbar-btn { background:rgba(255,255,255,0.02); border:1px solid rgba(255,255,255,0.03); padding:6px 8px; border-radius:8px; cursor:pointer; color:var(--muted); }
    .toolbar-btn.active { background: rgba(79,140,255,0.12); color: #cfe8ff; border-color: rgba(79,140,255,0.14); }
    /* make headers subtle in light/dark */
    html.light .sheet-header, html.light .row-header { color:#334155; border-bottom-color:#e6e6e6; border-right-color:#e6e6e6; }
    /* small helper */
    .panel-title { font-weight:600; color:#f8f9fa; margin-bottom:8px; font-size:14px; }
    html.light body { color:#0b1220; }
  </style>
</head>
<body class="p-4">
  <div class="max-w-7xl mx-auto grid grid-cols-12 gap-4">
    <!-- Left: sheets -->
    <aside class="col-span-3 panel p-4 flex flex-col gap-4" id="leftPanel">
      <div><input id="workbookName" placeholder="Workbook name" class="w-full panel p-2 rounded bg-transparent border border-white/5" /></div>
      <div>
        <div class="panel-title">Sheets</div>
        <div id="sheetsList" class="flex flex-col gap-2"></div>
        <div class="mt-3 flex gap-2">
          <button id="addSheetBtn" class="toolbar-btn">+ Sheet</button>
          <button id="exportWorkbookBtn" class="toolbar-btn">Export</button>
          <input id="importWorkbookInput" type="file" accept=".json" style="display:none" />
          <button id="importWorkbookBtn" class="toolbar-btn">Import</button>
        </div>
      </div>

      <div class="mt-auto text-sm text-white/70">
        <div class="mb-2">Grid controls</div>
        <div class="flex items-center gap-4">
          <div>Cols:<br/><input id="colCount" type="number" value="15" class="w-16 panel p-1 rounded bg-transparent border border-white/5" /></div>
          <div>Rows:<br/><input id="rowCount" type="number" value="40" class="w-16 panel p-1 rounded bg-transparent border border-white/5" /></div>
          <div><button id="resizeBtn" class="toolbar-btn">Resize</button></div>
        </div>
        <div class="mt-3 flex gap-2">
          <button id="undoBtn" class="toolbar-btn">Undo</button>
          <button id="redoBtn" class="toolbar-btn">Redo</button>
          <button id="saveBtn" class="toolbar-btn">Save</button>
        </div>
      </div>
    </aside>

    <!-- Right: main -->
    <section class="col-span-9 panel p-4 flex flex-col gap-3">
      <!-- top toolbar row: formatting + formula + controls -->
      <div class="flex items-center justify-between">
        <div class="flex items-center gap-3" id="toolbarContainer">
          <!-- formatting toolbar will be injected here -->
        </div>

        <div class="flex items-center gap-2">
          <input id="formula" placeholder="Click a cell or type = to start a formula" class="panel p-2 rounded w-96 bg-transparent border border-white/5" />
          <select id="cellFormat" class="panel p-2 rounded bg-transparent border border-white/5">
            <option value="auto">Text</option>
            <option value="number">Number</option>
            <option value="currency">Currency</option>
            <option value="date">Date</option>
          </select>
          <button id="toggleTheme" class="toolbar-btn">Theme</button>
          <button id="importCsvBtn" class="toolbar-btn">Import CSV</button>
          <input id="csvFile" type="file" accept=".csv" style="display:none"/>
          <button id="exportCsvBtn" class="toolbar-btn">Export CSV</button>
        </div>
      </div>

      <div id="gridViewport" class="virtual-viewport panel p-2">
        <table id="sheet" class="min-w-full"></table>
      </div>
    </section>
  </div>

  <script src="app.js"></script>
</body>
</html>
